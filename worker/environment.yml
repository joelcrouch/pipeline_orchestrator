name: pipeline-worker
channels:
  - pytorch
  - nvidia
  - conda-forge
  # Removed 'defaults' to avoid the deprecation warning and speed up solving
dependencies:
  - python=3.11
  - cuda-toolkit=12.1
  - cudnn=8.9
  - pytorch::pytorch=2.3
  - pytorch::torchvision
  - pytorch::pytorch-cuda=12.1
  - numpy=1.26
  - pandas
  - scipy
  - grpcio
  - grpcio-tools  # protoc Python plugin
  - fastapi
  - uvicorn
  - boto3  # S3/MinIO client
  - pytest
  - ruff # linter + formatter (replaces flake8/black/isort)
  - pip # always include so pip install below works
  - pip:
    - protobuf # sometimes newer than conda-forge, keep in pip section
    - grpcio-status
    - prometheus-client